TODO
===================

- add some further tests
- investigate whether there is some way to implement full broadcasting without .choose.
- possibly write a similar version of 'choose'

